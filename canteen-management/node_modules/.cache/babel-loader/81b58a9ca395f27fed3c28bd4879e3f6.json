{"ast":null,"code":"export var Html5QrcodeScannerState;\n(function (Html5QrcodeScannerState) {\n  Html5QrcodeScannerState[Html5QrcodeScannerState[\"UNKNOWN\"] = 0] = \"UNKNOWN\";\n  Html5QrcodeScannerState[Html5QrcodeScannerState[\"NOT_STARTED\"] = 1] = \"NOT_STARTED\";\n  Html5QrcodeScannerState[Html5QrcodeScannerState[\"SCANNING\"] = 2] = \"SCANNING\";\n  Html5QrcodeScannerState[Html5QrcodeScannerState[\"PAUSED\"] = 3] = \"PAUSED\";\n})(Html5QrcodeScannerState || (Html5QrcodeScannerState = {}));\nvar StateManagerImpl = function () {\n  function StateManagerImpl() {\n    this.state = Html5QrcodeScannerState.NOT_STARTED;\n    this.onGoingTransactionNewState = Html5QrcodeScannerState.UNKNOWN;\n  }\n  StateManagerImpl.prototype.directTransition = function (newState) {\n    this.failIfTransitionOngoing();\n    this.validateTransition(newState);\n    this.state = newState;\n  };\n  StateManagerImpl.prototype.startTransition = function (newState) {\n    this.failIfTransitionOngoing();\n    this.validateTransition(newState);\n    this.onGoingTransactionNewState = newState;\n    return this;\n  };\n  StateManagerImpl.prototype.execute = function () {\n    if (this.onGoingTransactionNewState === Html5QrcodeScannerState.UNKNOWN) {\n      throw \"Transaction is already cancelled, cannot execute().\";\n    }\n    var tempNewState = this.onGoingTransactionNewState;\n    this.onGoingTransactionNewState = Html5QrcodeScannerState.UNKNOWN;\n    this.directTransition(tempNewState);\n  };\n  StateManagerImpl.prototype.cancel = function () {\n    if (this.onGoingTransactionNewState === Html5QrcodeScannerState.UNKNOWN) {\n      throw \"Transaction is already cancelled, cannot cancel().\";\n    }\n    this.onGoingTransactionNewState = Html5QrcodeScannerState.UNKNOWN;\n  };\n  StateManagerImpl.prototype.getState = function () {\n    return this.state;\n  };\n  StateManagerImpl.prototype.failIfTransitionOngoing = function () {\n    if (this.onGoingTransactionNewState !== Html5QrcodeScannerState.UNKNOWN) {\n      throw \"Cannot transition to a new state, already under transition\";\n    }\n  };\n  StateManagerImpl.prototype.validateTransition = function (newState) {\n    switch (this.state) {\n      case Html5QrcodeScannerState.UNKNOWN:\n        throw \"Transition from unknown is not allowed\";\n      case Html5QrcodeScannerState.NOT_STARTED:\n        this.failIfNewStateIs(newState, [Html5QrcodeScannerState.PAUSED]);\n        break;\n      case Html5QrcodeScannerState.SCANNING:\n        break;\n      case Html5QrcodeScannerState.PAUSED:\n        break;\n    }\n  };\n  StateManagerImpl.prototype.failIfNewStateIs = function (newState, disallowedStatesToTransition) {\n    for (var _i = 0, disallowedStatesToTransition_1 = disallowedStatesToTransition; _i < disallowedStatesToTransition_1.length; _i++) {\n      var disallowedState = disallowedStatesToTransition_1[_i];\n      if (newState === disallowedState) {\n        throw \"Cannot transition from \".concat(this.state, \" to \").concat(newState);\n      }\n    }\n  };\n  return StateManagerImpl;\n}();\nvar StateManagerProxy = function () {\n  function StateManagerProxy(stateManager) {\n    this.stateManager = stateManager;\n  }\n  StateManagerProxy.prototype.startTransition = function (newState) {\n    return this.stateManager.startTransition(newState);\n  };\n  StateManagerProxy.prototype.directTransition = function (newState) {\n    this.stateManager.directTransition(newState);\n  };\n  StateManagerProxy.prototype.getState = function () {\n    return this.stateManager.getState();\n  };\n  StateManagerProxy.prototype.canScanFile = function () {\n    return this.stateManager.getState() === Html5QrcodeScannerState.NOT_STARTED;\n  };\n  StateManagerProxy.prototype.isScanning = function () {\n    return this.stateManager.getState() !== Html5QrcodeScannerState.NOT_STARTED;\n  };\n  StateManagerProxy.prototype.isStrictlyScanning = function () {\n    return this.stateManager.getState() === Html5QrcodeScannerState.SCANNING;\n  };\n  StateManagerProxy.prototype.isPaused = function () {\n    return this.stateManager.getState() === Html5QrcodeScannerState.PAUSED;\n  };\n  return StateManagerProxy;\n}();\nexport { StateManagerProxy };\nvar StateManagerFactory = function () {\n  function StateManagerFactory() {}\n  StateManagerFactory.create = function () {\n    return new StateManagerProxy(new StateManagerImpl());\n  };\n  return StateManagerFactory;\n}();\nexport { StateManagerFactory };","map":{"version":3,"sources":["../../src/state-manager.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["export var Html5QrcodeScannerState;\n(function (Html5QrcodeScannerState) {\n    Html5QrcodeScannerState[Html5QrcodeScannerState[\"UNKNOWN\"] = 0] = \"UNKNOWN\";\n    Html5QrcodeScannerState[Html5QrcodeScannerState[\"NOT_STARTED\"] = 1] = \"NOT_STARTED\";\n    Html5QrcodeScannerState[Html5QrcodeScannerState[\"SCANNING\"] = 2] = \"SCANNING\";\n    Html5QrcodeScannerState[Html5QrcodeScannerState[\"PAUSED\"] = 3] = \"PAUSED\";\n})(Html5QrcodeScannerState || (Html5QrcodeScannerState = {}));\nvar StateManagerImpl = (function () {\n    function StateManagerImpl() {\n        this.state = Html5QrcodeScannerState.NOT_STARTED;\n        this.onGoingTransactionNewState = Html5QrcodeScannerState.UNKNOWN;\n    }\n    StateManagerImpl.prototype.directTransition = function (newState) {\n        this.failIfTransitionOngoing();\n        this.validateTransition(newState);\n        this.state = newState;\n    };\n    StateManagerImpl.prototype.startTransition = function (newState) {\n        this.failIfTransitionOngoing();\n        this.validateTransition(newState);\n        this.onGoingTransactionNewState = newState;\n        return this;\n    };\n    StateManagerImpl.prototype.execute = function () {\n        if (this.onGoingTransactionNewState\n            === Html5QrcodeScannerState.UNKNOWN) {\n            throw \"Transaction is already cancelled, cannot execute().\";\n        }\n        var tempNewState = this.onGoingTransactionNewState;\n        this.onGoingTransactionNewState = Html5QrcodeScannerState.UNKNOWN;\n        this.directTransition(tempNewState);\n    };\n    StateManagerImpl.prototype.cancel = function () {\n        if (this.onGoingTransactionNewState\n            === Html5QrcodeScannerState.UNKNOWN) {\n            throw \"Transaction is already cancelled, cannot cancel().\";\n        }\n        this.onGoingTransactionNewState = Html5QrcodeScannerState.UNKNOWN;\n    };\n    StateManagerImpl.prototype.getState = function () {\n        return this.state;\n    };\n    StateManagerImpl.prototype.failIfTransitionOngoing = function () {\n        if (this.onGoingTransactionNewState\n            !== Html5QrcodeScannerState.UNKNOWN) {\n            throw \"Cannot transition to a new state, already under transition\";\n        }\n    };\n    StateManagerImpl.prototype.validateTransition = function (newState) {\n        switch (this.state) {\n            case Html5QrcodeScannerState.UNKNOWN:\n                throw \"Transition from unknown is not allowed\";\n            case Html5QrcodeScannerState.NOT_STARTED:\n                this.failIfNewStateIs(newState, [Html5QrcodeScannerState.PAUSED]);\n                break;\n            case Html5QrcodeScannerState.SCANNING:\n                break;\n            case Html5QrcodeScannerState.PAUSED:\n                break;\n        }\n    };\n    StateManagerImpl.prototype.failIfNewStateIs = function (newState, disallowedStatesToTransition) {\n        for (var _i = 0, disallowedStatesToTransition_1 = disallowedStatesToTransition; _i < disallowedStatesToTransition_1.length; _i++) {\n            var disallowedState = disallowedStatesToTransition_1[_i];\n            if (newState === disallowedState) {\n                throw \"Cannot transition from \".concat(this.state, \" to \").concat(newState);\n            }\n        }\n    };\n    return StateManagerImpl;\n}());\nvar StateManagerProxy = (function () {\n    function StateManagerProxy(stateManager) {\n        this.stateManager = stateManager;\n    }\n    StateManagerProxy.prototype.startTransition = function (newState) {\n        return this.stateManager.startTransition(newState);\n    };\n    StateManagerProxy.prototype.directTransition = function (newState) {\n        this.stateManager.directTransition(newState);\n    };\n    StateManagerProxy.prototype.getState = function () {\n        return this.stateManager.getState();\n    };\n    StateManagerProxy.prototype.canScanFile = function () {\n        return this.stateManager.getState() === Html5QrcodeScannerState.NOT_STARTED;\n    };\n    StateManagerProxy.prototype.isScanning = function () {\n        return this.stateManager.getState() !== Html5QrcodeScannerState.NOT_STARTED;\n    };\n    StateManagerProxy.prototype.isStrictlyScanning = function () {\n        return this.stateManager.getState() === Html5QrcodeScannerState.SCANNING;\n    };\n    StateManagerProxy.prototype.isPaused = function () {\n        return this.stateManager.getState() === Html5QrcodeScannerState.PAUSED;\n    };\n    return StateManagerProxy;\n}());\nexport { StateManagerProxy };\nvar StateManagerFactory = (function () {\n    function StateManagerFactory() {\n    }\n    StateManagerFactory.create = function () {\n        return new StateManagerProxy(new StateManagerImpl());\n    };\n    return StateManagerFactory;\n}());\nexport { StateManagerFactory };\n//# sourceMappingURL=state-manager.js.map"]},"metadata":{},"sourceType":"module"}