{"ast":null,"code":"import { Html5QrcodeConstants, Html5QrcodeScanType, Html5QrcodeErrorFactory, BaseLoggger, isNullOrUndefined, clip } from \"./core\";\nimport { Html5Qrcode } from \"./html5-qrcode\";\nimport { Html5QrcodeScannerStrings } from \"./strings\";\nimport { ASSET_FILE_SCAN, ASSET_CAMERA_SCAN } from \"./image-assets\";\nimport { PersistedDataManager } from \"./storage\";\nimport { LibraryInfoContainer } from \"./ui\";\nimport { CameraPermissions } from \"./camera/permissions\";\nimport { ScanTypeSelector } from \"./ui/scanner/scan-type-selector\";\nimport { TorchButton } from \"./ui/scanner/torch-button\";\nimport { FileSelectionUi } from \"./ui/scanner/file-selection-ui\";\nimport { BaseUiElementFactory, PublicUiElementIdAndClasses } from \"./ui/scanner/base\";\nimport { CameraSelectionUi } from \"./ui/scanner/camera-selection-ui\";\nimport { CameraZoomUi } from \"./ui/scanner/camera-zoom-ui\";\nvar Html5QrcodeScannerStatus;\n(function (Html5QrcodeScannerStatus) {\n  Html5QrcodeScannerStatus[Html5QrcodeScannerStatus[\"STATUS_DEFAULT\"] = 0] = \"STATUS_DEFAULT\";\n  Html5QrcodeScannerStatus[Html5QrcodeScannerStatus[\"STATUS_SUCCESS\"] = 1] = \"STATUS_SUCCESS\";\n  Html5QrcodeScannerStatus[Html5QrcodeScannerStatus[\"STATUS_WARNING\"] = 2] = \"STATUS_WARNING\";\n  Html5QrcodeScannerStatus[Html5QrcodeScannerStatus[\"STATUS_REQUESTING_PERMISSION\"] = 3] = \"STATUS_REQUESTING_PERMISSION\";\n})(Html5QrcodeScannerStatus || (Html5QrcodeScannerStatus = {}));\nfunction toHtml5QrcodeCameraScanConfig(config) {\n  return {\n    fps: config.fps,\n    qrbox: config.qrbox,\n    aspectRatio: config.aspectRatio,\n    disableFlip: config.disableFlip,\n    videoConstraints: config.videoConstraints\n  };\n}\nfunction toHtml5QrcodeFullConfig(config, verbose) {\n  return {\n    formatsToSupport: config.formatsToSupport,\n    useBarCodeDetectorIfSupported: config.useBarCodeDetectorIfSupported,\n    experimentalFeatures: config.experimentalFeatures,\n    verbose: verbose\n  };\n}\nvar Html5QrcodeScanner = function () {\n  function Html5QrcodeScanner(elementId, config, verbose) {\n    this.lastMatchFound = null;\n    this.cameraScanImage = null;\n    this.fileScanImage = null;\n    this.fileSelectionUi = null;\n    this.elementId = elementId;\n    this.config = this.createConfig(config);\n    this.verbose = verbose === true;\n    if (!document.getElementById(elementId)) {\n      throw \"HTML Element with id=\".concat(elementId, \" not found\");\n    }\n    this.scanTypeSelector = new ScanTypeSelector(this.config.supportedScanTypes);\n    this.currentScanType = this.scanTypeSelector.getDefaultScanType();\n    this.sectionSwapAllowed = true;\n    this.logger = new BaseLoggger(this.verbose);\n    this.persistedDataManager = new PersistedDataManager();\n    if (config.rememberLastUsedCamera !== true) {\n      this.persistedDataManager.reset();\n    }\n  }\n  Html5QrcodeScanner.prototype.render = function (qrCodeSuccessCallback, qrCodeErrorCallback) {\n    var _this = this;\n    this.lastMatchFound = null;\n    this.qrCodeSuccessCallback = function (decodedText, result) {\n      if (qrCodeSuccessCallback) {\n        qrCodeSuccessCallback(decodedText, result);\n      } else {\n        if (_this.lastMatchFound === decodedText) {\n          return;\n        }\n        _this.lastMatchFound = decodedText;\n        _this.setHeaderMessage(Html5QrcodeScannerStrings.lastMatch(decodedText), Html5QrcodeScannerStatus.STATUS_SUCCESS);\n      }\n    };\n    this.qrCodeErrorCallback = function (errorMessage, error) {\n      if (qrCodeErrorCallback) {\n        qrCodeErrorCallback(errorMessage, error);\n      }\n    };\n    var container = document.getElementById(this.elementId);\n    if (!container) {\n      throw \"HTML Element with id=\".concat(this.elementId, \" not found\");\n    }\n    container.innerHTML = \"\";\n    this.createBasicLayout(container);\n    this.html5Qrcode = new Html5Qrcode(this.getScanRegionId(), toHtml5QrcodeFullConfig(this.config, this.verbose));\n  };\n  Html5QrcodeScanner.prototype.pause = function (shouldPauseVideo) {\n    if (isNullOrUndefined(shouldPauseVideo) || shouldPauseVideo !== true) {\n      shouldPauseVideo = false;\n    }\n    this.getHtml5QrcodeOrFail().pause(shouldPauseVideo);\n  };\n  Html5QrcodeScanner.prototype.resume = function () {\n    this.getHtml5QrcodeOrFail().resume();\n  };\n  Html5QrcodeScanner.prototype.getState = function () {\n    return this.getHtml5QrcodeOrFail().getState();\n  };\n  Html5QrcodeScanner.prototype.clear = function () {\n    var _this = this;\n    var emptyHtmlContainer = function () {\n      var mainContainer = document.getElementById(_this.elementId);\n      if (mainContainer) {\n        mainContainer.innerHTML = \"\";\n        _this.resetBasicLayout(mainContainer);\n      }\n    };\n    if (this.html5Qrcode) {\n      return new Promise(function (resolve, reject) {\n        if (!_this.html5Qrcode) {\n          resolve();\n          return;\n        }\n        if (_this.html5Qrcode.isScanning) {\n          _this.html5Qrcode.stop().then(function (_) {\n            if (!_this.html5Qrcode) {\n              resolve();\n              return;\n            }\n            _this.html5Qrcode.clear();\n            emptyHtmlContainer();\n            resolve();\n          }).catch(function (error) {\n            if (_this.verbose) {\n              _this.logger.logError(\"Unable to stop qrcode scanner\", error);\n            }\n            reject(error);\n          });\n        } else {\n          _this.html5Qrcode.clear();\n          emptyHtmlContainer();\n          resolve();\n        }\n      });\n    }\n    return Promise.resolve();\n  };\n  Html5QrcodeScanner.prototype.getRunningTrackCapabilities = function () {\n    return this.getHtml5QrcodeOrFail().getRunningTrackCapabilities();\n  };\n  Html5QrcodeScanner.prototype.getRunningTrackSettings = function () {\n    return this.getHtml5QrcodeOrFail().getRunningTrackSettings();\n  };\n  Html5QrcodeScanner.prototype.applyVideoConstraints = function (videoConstaints) {\n    return this.getHtml5QrcodeOrFail().applyVideoConstraints(videoConstaints);\n  };\n  Html5QrcodeScanner.prototype.getHtml5QrcodeOrFail = function () {\n    if (!this.html5Qrcode) {\n      throw \"Code scanner not initialized.\";\n    }\n    return this.html5Qrcode;\n  };\n  Html5QrcodeScanner.prototype.createConfig = function (config) {\n    if (config) {\n      if (!config.fps) {\n        config.fps = Html5QrcodeConstants.SCAN_DEFAULT_FPS;\n      }\n      if (config.rememberLastUsedCamera !== !Html5QrcodeConstants.DEFAULT_REMEMBER_LAST_CAMERA_USED) {\n        config.rememberLastUsedCamera = Html5QrcodeConstants.DEFAULT_REMEMBER_LAST_CAMERA_USED;\n      }\n      if (!config.supportedScanTypes) {\n        config.supportedScanTypes = Html5QrcodeConstants.DEFAULT_SUPPORTED_SCAN_TYPE;\n      }\n      return config;\n    }\n    return {\n      fps: Html5QrcodeConstants.SCAN_DEFAULT_FPS,\n      rememberLastUsedCamera: Html5QrcodeConstants.DEFAULT_REMEMBER_LAST_CAMERA_USED,\n      supportedScanTypes: Html5QrcodeConstants.DEFAULT_SUPPORTED_SCAN_TYPE\n    };\n  };\n  Html5QrcodeScanner.prototype.createBasicLayout = function (parent) {\n    parent.style.position = \"relative\";\n    parent.style.padding = \"0px\";\n    parent.style.border = \"1px solid silver\";\n    this.createHeader(parent);\n    var qrCodeScanRegion = document.createElement(\"div\");\n    var scanRegionId = this.getScanRegionId();\n    qrCodeScanRegion.id = scanRegionId;\n    qrCodeScanRegion.style.width = \"100%\";\n    qrCodeScanRegion.style.minHeight = \"100px\";\n    qrCodeScanRegion.style.textAlign = \"center\";\n    parent.appendChild(qrCodeScanRegion);\n    if (ScanTypeSelector.isCameraScanType(this.currentScanType)) {\n      this.insertCameraScanImageToScanRegion();\n    } else {\n      this.insertFileScanImageToScanRegion();\n    }\n    var qrCodeDashboard = document.createElement(\"div\");\n    var dashboardId = this.getDashboardId();\n    qrCodeDashboard.id = dashboardId;\n    qrCodeDashboard.style.width = \"100%\";\n    parent.appendChild(qrCodeDashboard);\n    this.setupInitialDashboard(qrCodeDashboard);\n  };\n  Html5QrcodeScanner.prototype.resetBasicLayout = function (mainContainer) {\n    mainContainer.style.border = \"none\";\n  };\n  Html5QrcodeScanner.prototype.setupInitialDashboard = function (dashboard) {\n    this.createSection(dashboard);\n    this.createSectionControlPanel();\n    if (this.scanTypeSelector.hasMoreThanOneScanType()) {\n      this.createSectionSwap();\n    }\n  };\n  Html5QrcodeScanner.prototype.createHeader = function (dashboard) {\n    var header = document.createElement(\"div\");\n    header.style.textAlign = \"left\";\n    header.style.margin = \"0px\";\n    dashboard.appendChild(header);\n    var libraryInfo = new LibraryInfoContainer();\n    libraryInfo.renderInto(header);\n    var headerMessageContainer = document.createElement(\"div\");\n    headerMessageContainer.id = this.getHeaderMessageContainerId();\n    headerMessageContainer.style.display = \"none\";\n    headerMessageContainer.style.textAlign = \"center\";\n    headerMessageContainer.style.fontSize = \"14px\";\n    headerMessageContainer.style.padding = \"2px 10px\";\n    headerMessageContainer.style.margin = \"4px\";\n    headerMessageContainer.style.borderTop = \"1px solid #f6f6f6\";\n    header.appendChild(headerMessageContainer);\n  };\n  Html5QrcodeScanner.prototype.createSection = function (dashboard) {\n    var section = document.createElement(\"div\");\n    section.id = this.getDashboardSectionId();\n    section.style.width = \"100%\";\n    section.style.padding = \"10px 0px 10px 0px\";\n    section.style.textAlign = \"left\";\n    dashboard.appendChild(section);\n  };\n  Html5QrcodeScanner.prototype.createCameraListUi = function (scpCameraScanRegion, requestPermissionContainer, requestPermissionButton) {\n    var $this = this;\n    $this.showHideScanTypeSwapLink(false);\n    $this.setHeaderMessage(Html5QrcodeScannerStrings.cameraPermissionRequesting());\n    var createPermissionButtonIfNotExists = function () {\n      if (!requestPermissionButton) {\n        $this.createPermissionButton(scpCameraScanRegion, requestPermissionContainer);\n      }\n    };\n    Html5Qrcode.getCameras().then(function (cameras) {\n      $this.persistedDataManager.setHasPermission(true);\n      $this.showHideScanTypeSwapLink(true);\n      $this.resetHeaderMessage();\n      if (cameras && cameras.length > 0) {\n        scpCameraScanRegion.removeChild(requestPermissionContainer);\n        $this.renderCameraSelection(cameras);\n      } else {\n        $this.setHeaderMessage(Html5QrcodeScannerStrings.noCameraFound(), Html5QrcodeScannerStatus.STATUS_WARNING);\n        createPermissionButtonIfNotExists();\n      }\n    }).catch(function (error) {\n      $this.persistedDataManager.setHasPermission(false);\n      if (requestPermissionButton) {\n        requestPermissionButton.disabled = false;\n      } else {\n        createPermissionButtonIfNotExists();\n      }\n      $this.setHeaderMessage(error, Html5QrcodeScannerStatus.STATUS_WARNING);\n      $this.showHideScanTypeSwapLink(true);\n    });\n  };\n  Html5QrcodeScanner.prototype.createPermissionButton = function (scpCameraScanRegion, requestPermissionContainer) {\n    var $this = this;\n    var requestPermissionButton = BaseUiElementFactory.createElement(\"button\", this.getCameraPermissionButtonId());\n    requestPermissionButton.innerText = Html5QrcodeScannerStrings.cameraPermissionTitle();\n    requestPermissionButton.addEventListener(\"click\", function () {\n      requestPermissionButton.disabled = true;\n      $this.createCameraListUi(scpCameraScanRegion, requestPermissionContainer, requestPermissionButton);\n    });\n    requestPermissionContainer.appendChild(requestPermissionButton);\n  };\n  Html5QrcodeScanner.prototype.createPermissionsUi = function (scpCameraScanRegion, requestPermissionContainer) {\n    var $this = this;\n    if (ScanTypeSelector.isCameraScanType(this.currentScanType) && this.persistedDataManager.hasCameraPermissions()) {\n      CameraPermissions.hasPermissions().then(function (hasPermissions) {\n        if (hasPermissions) {\n          $this.createCameraListUi(scpCameraScanRegion, requestPermissionContainer);\n        } else {\n          $this.persistedDataManager.setHasPermission(false);\n          $this.createPermissionButton(scpCameraScanRegion, requestPermissionContainer);\n        }\n      }).catch(function (_) {\n        $this.persistedDataManager.setHasPermission(false);\n        $this.createPermissionButton(scpCameraScanRegion, requestPermissionContainer);\n      });\n      return;\n    }\n    this.createPermissionButton(scpCameraScanRegion, requestPermissionContainer);\n  };\n  Html5QrcodeScanner.prototype.createSectionControlPanel = function () {\n    var section = document.getElementById(this.getDashboardSectionId());\n    var sectionControlPanel = document.createElement(\"div\");\n    section.appendChild(sectionControlPanel);\n    var scpCameraScanRegion = document.createElement(\"div\");\n    scpCameraScanRegion.id = this.getDashboardSectionCameraScanRegionId();\n    scpCameraScanRegion.style.display = ScanTypeSelector.isCameraScanType(this.currentScanType) ? \"block\" : \"none\";\n    sectionControlPanel.appendChild(scpCameraScanRegion);\n    var requestPermissionContainer = document.createElement(\"div\");\n    requestPermissionContainer.style.textAlign = \"center\";\n    scpCameraScanRegion.appendChild(requestPermissionContainer);\n    if (this.scanTypeSelector.isCameraScanRequired()) {\n      this.createPermissionsUi(scpCameraScanRegion, requestPermissionContainer);\n    }\n    this.renderFileScanUi(sectionControlPanel);\n  };\n  Html5QrcodeScanner.prototype.renderFileScanUi = function (parent) {\n    var showOnRender = ScanTypeSelector.isFileScanType(this.currentScanType);\n    var $this = this;\n    var onFileSelected = function (file) {\n      if (!$this.html5Qrcode) {\n        throw \"html5Qrcode not defined\";\n      }\n      if (!ScanTypeSelector.isFileScanType($this.currentScanType)) {\n        return;\n      }\n      $this.setHeaderMessage(Html5QrcodeScannerStrings.loadingImage());\n      $this.html5Qrcode.scanFileV2(file, true).then(function (html5qrcodeResult) {\n        $this.resetHeaderMessage();\n        $this.qrCodeSuccessCallback(html5qrcodeResult.decodedText, html5qrcodeResult);\n      }).catch(function (error) {\n        $this.setHeaderMessage(error, Html5QrcodeScannerStatus.STATUS_WARNING);\n        $this.qrCodeErrorCallback(error, Html5QrcodeErrorFactory.createFrom(error));\n      });\n    };\n    this.fileSelectionUi = FileSelectionUi.create(parent, showOnRender, onFileSelected);\n  };\n  Html5QrcodeScanner.prototype.renderCameraSelection = function (cameras) {\n    var _this = this;\n    var $this = this;\n    var scpCameraScanRegion = document.getElementById(this.getDashboardSectionCameraScanRegionId());\n    scpCameraScanRegion.style.textAlign = \"center\";\n    var cameraZoomUi = CameraZoomUi.create(scpCameraScanRegion, false);\n    var renderCameraZoomUiIfSupported = function (cameraCapabilities) {\n      var zoomCapability = cameraCapabilities.zoomFeature();\n      if (!zoomCapability.isSupported()) {\n        return;\n      }\n      cameraZoomUi.setOnCameraZoomValueChangeCallback(function (zoomValue) {\n        zoomCapability.apply(zoomValue);\n      });\n      var defaultZoom = 1;\n      if (_this.config.defaultZoomValueIfSupported) {\n        defaultZoom = _this.config.defaultZoomValueIfSupported;\n      }\n      defaultZoom = clip(defaultZoom, zoomCapability.min(), zoomCapability.max());\n      cameraZoomUi.setValues(zoomCapability.min(), zoomCapability.max(), defaultZoom, zoomCapability.step());\n      cameraZoomUi.show();\n    };\n    var cameraSelectUi = CameraSelectionUi.create(scpCameraScanRegion, cameras);\n    var cameraActionContainer = document.createElement(\"span\");\n    var cameraActionStartButton = BaseUiElementFactory.createElement(\"button\", PublicUiElementIdAndClasses.CAMERA_START_BUTTON_ID);\n    cameraActionStartButton.innerText = Html5QrcodeScannerStrings.scanButtonStartScanningText();\n    cameraActionContainer.appendChild(cameraActionStartButton);\n    var cameraActionStopButton = BaseUiElementFactory.createElement(\"button\", PublicUiElementIdAndClasses.CAMERA_STOP_BUTTON_ID);\n    cameraActionStopButton.innerText = Html5QrcodeScannerStrings.scanButtonStopScanningText();\n    cameraActionStopButton.style.display = \"none\";\n    cameraActionStopButton.disabled = true;\n    cameraActionContainer.appendChild(cameraActionStopButton);\n    var torchButton;\n    var createAndShowTorchButtonIfSupported = function (cameraCapabilities) {\n      if (!cameraCapabilities.torchFeature().isSupported()) {\n        if (torchButton) {\n          torchButton.hide();\n        }\n        return;\n      }\n      if (!torchButton) {\n        torchButton = TorchButton.create(cameraActionContainer, cameraCapabilities.torchFeature(), {\n          display: \"none\",\n          marginLeft: \"5px\"\n        }, function (errorMessage) {\n          $this.setHeaderMessage(errorMessage, Html5QrcodeScannerStatus.STATUS_WARNING);\n        });\n      } else {\n        torchButton.updateTorchCapability(cameraCapabilities.torchFeature());\n      }\n      torchButton.show();\n    };\n    scpCameraScanRegion.appendChild(cameraActionContainer);\n    var resetCameraActionStartButton = function (shouldShow) {\n      if (!shouldShow) {\n        cameraActionStartButton.style.display = \"none\";\n      }\n      cameraActionStartButton.innerText = Html5QrcodeScannerStrings.scanButtonStartScanningText();\n      cameraActionStartButton.style.opacity = \"1\";\n      cameraActionStartButton.disabled = false;\n      if (shouldShow) {\n        cameraActionStartButton.style.display = \"inline-block\";\n      }\n    };\n    cameraActionStartButton.addEventListener(\"click\", function (_) {\n      cameraActionStartButton.innerText = Html5QrcodeScannerStrings.scanButtonScanningStarting();\n      cameraSelectUi.disable();\n      cameraActionStartButton.disabled = true;\n      cameraActionStartButton.style.opacity = \"0.5\";\n      if (_this.scanTypeSelector.hasMoreThanOneScanType()) {\n        $this.showHideScanTypeSwapLink(false);\n      }\n      $this.resetHeaderMessage();\n      var cameraId = cameraSelectUi.getValue();\n      $this.persistedDataManager.setLastUsedCameraId(cameraId);\n      $this.html5Qrcode.start(cameraId, toHtml5QrcodeCameraScanConfig($this.config), $this.qrCodeSuccessCallback, $this.qrCodeErrorCallback).then(function (_) {\n        cameraActionStopButton.disabled = false;\n        cameraActionStopButton.style.display = \"inline-block\";\n        resetCameraActionStartButton(false);\n        var cameraCapabilities = $this.html5Qrcode.getRunningTrackCameraCapabilities();\n        if (_this.config.showTorchButtonIfSupported === true) {\n          createAndShowTorchButtonIfSupported(cameraCapabilities);\n        }\n        if (_this.config.showZoomSliderIfSupported === true) {\n          renderCameraZoomUiIfSupported(cameraCapabilities);\n        }\n      }).catch(function (error) {\n        $this.showHideScanTypeSwapLink(true);\n        cameraSelectUi.enable();\n        resetCameraActionStartButton(true);\n        $this.setHeaderMessage(error, Html5QrcodeScannerStatus.STATUS_WARNING);\n      });\n    });\n    if (cameraSelectUi.hasSingleItem()) {\n      cameraActionStartButton.click();\n    }\n    cameraActionStopButton.addEventListener(\"click\", function (_) {\n      if (!$this.html5Qrcode) {\n        throw \"html5Qrcode not defined\";\n      }\n      cameraActionStopButton.disabled = true;\n      $this.html5Qrcode.stop().then(function (_) {\n        if (_this.scanTypeSelector.hasMoreThanOneScanType()) {\n          $this.showHideScanTypeSwapLink(true);\n        }\n        cameraSelectUi.enable();\n        cameraActionStartButton.disabled = false;\n        cameraActionStopButton.style.display = \"none\";\n        cameraActionStartButton.style.display = \"inline-block\";\n        if (torchButton) {\n          torchButton.reset();\n          torchButton.hide();\n        }\n        cameraZoomUi.removeOnCameraZoomValueChangeCallback();\n        cameraZoomUi.hide();\n        $this.insertCameraScanImageToScanRegion();\n      }).catch(function (error) {\n        cameraActionStopButton.disabled = false;\n        $this.setHeaderMessage(error, Html5QrcodeScannerStatus.STATUS_WARNING);\n      });\n    });\n    if ($this.persistedDataManager.getLastUsedCameraId()) {\n      var cameraId = $this.persistedDataManager.getLastUsedCameraId();\n      if (cameraSelectUi.hasValue(cameraId)) {\n        cameraSelectUi.setValue(cameraId);\n        cameraActionStartButton.click();\n      } else {\n        $this.persistedDataManager.resetLastUsedCameraId();\n      }\n    }\n  };\n  Html5QrcodeScanner.prototype.createSectionSwap = function () {\n    var $this = this;\n    var TEXT_IF_CAMERA_SCAN_SELECTED = Html5QrcodeScannerStrings.textIfCameraScanSelected();\n    var TEXT_IF_FILE_SCAN_SELECTED = Html5QrcodeScannerStrings.textIfFileScanSelected();\n    var section = document.getElementById(this.getDashboardSectionId());\n    var switchContainer = document.createElement(\"div\");\n    switchContainer.style.textAlign = \"center\";\n    var switchScanTypeLink = BaseUiElementFactory.createElement(\"span\", this.getDashboardSectionSwapLinkId());\n    switchScanTypeLink.style.textDecoration = \"underline\";\n    switchScanTypeLink.style.cursor = \"pointer\";\n    switchScanTypeLink.innerText = ScanTypeSelector.isCameraScanType(this.currentScanType) ? TEXT_IF_CAMERA_SCAN_SELECTED : TEXT_IF_FILE_SCAN_SELECTED;\n    switchScanTypeLink.addEventListener(\"click\", function () {\n      if (!$this.sectionSwapAllowed) {\n        if ($this.verbose) {\n          $this.logger.logError(\"Section swap called when not allowed\");\n        }\n        return;\n      }\n      $this.resetHeaderMessage();\n      $this.fileSelectionUi.resetValue();\n      $this.sectionSwapAllowed = false;\n      if (ScanTypeSelector.isCameraScanType($this.currentScanType)) {\n        $this.clearScanRegion();\n        $this.getCameraScanRegion().style.display = \"none\";\n        $this.fileSelectionUi.show();\n        switchScanTypeLink.innerText = TEXT_IF_FILE_SCAN_SELECTED;\n        $this.currentScanType = Html5QrcodeScanType.SCAN_TYPE_FILE;\n        $this.insertFileScanImageToScanRegion();\n      } else {\n        $this.clearScanRegion();\n        $this.getCameraScanRegion().style.display = \"block\";\n        $this.fileSelectionUi.hide();\n        switchScanTypeLink.innerText = TEXT_IF_CAMERA_SCAN_SELECTED;\n        $this.currentScanType = Html5QrcodeScanType.SCAN_TYPE_CAMERA;\n        $this.insertCameraScanImageToScanRegion();\n        $this.startCameraScanIfPermissionExistsOnSwap();\n      }\n      $this.sectionSwapAllowed = true;\n    });\n    switchContainer.appendChild(switchScanTypeLink);\n    section.appendChild(switchContainer);\n  };\n  Html5QrcodeScanner.prototype.startCameraScanIfPermissionExistsOnSwap = function () {\n    var _this = this;\n    var $this = this;\n    if (this.persistedDataManager.hasCameraPermissions()) {\n      CameraPermissions.hasPermissions().then(function (hasPermissions) {\n        if (hasPermissions) {\n          var permissionButton = document.getElementById($this.getCameraPermissionButtonId());\n          if (!permissionButton) {\n            _this.logger.logError(\"Permission button not found, fail;\");\n            throw \"Permission button not found\";\n          }\n          permissionButton.click();\n        } else {\n          $this.persistedDataManager.setHasPermission(false);\n        }\n      }).catch(function (_) {\n        $this.persistedDataManager.setHasPermission(false);\n      });\n      return;\n    }\n  };\n  Html5QrcodeScanner.prototype.resetHeaderMessage = function () {\n    var messageDiv = document.getElementById(this.getHeaderMessageContainerId());\n    messageDiv.style.display = \"none\";\n  };\n  Html5QrcodeScanner.prototype.setHeaderMessage = function (messageText, scannerStatus) {\n    if (!scannerStatus) {\n      scannerStatus = Html5QrcodeScannerStatus.STATUS_DEFAULT;\n    }\n    var messageDiv = this.getHeaderMessageDiv();\n    messageDiv.innerText = messageText;\n    messageDiv.style.display = \"block\";\n    switch (scannerStatus) {\n      case Html5QrcodeScannerStatus.STATUS_SUCCESS:\n        messageDiv.style.background = \"rgba(106, 175, 80, 0.26)\";\n        messageDiv.style.color = \"#477735\";\n        break;\n      case Html5QrcodeScannerStatus.STATUS_WARNING:\n        messageDiv.style.background = \"rgba(203, 36, 49, 0.14)\";\n        messageDiv.style.color = \"#cb2431\";\n        break;\n      case Html5QrcodeScannerStatus.STATUS_DEFAULT:\n      default:\n        messageDiv.style.background = \"rgba(0, 0, 0, 0)\";\n        messageDiv.style.color = \"rgb(17, 17, 17)\";\n        break;\n    }\n  };\n  Html5QrcodeScanner.prototype.showHideScanTypeSwapLink = function (shouldDisplay) {\n    if (this.scanTypeSelector.hasMoreThanOneScanType()) {\n      if (shouldDisplay !== true) {\n        shouldDisplay = false;\n      }\n      this.sectionSwapAllowed = shouldDisplay;\n      this.getDashboardSectionSwapLink().style.display = shouldDisplay ? \"inline-block\" : \"none\";\n    }\n  };\n  Html5QrcodeScanner.prototype.insertCameraScanImageToScanRegion = function () {\n    var $this = this;\n    var qrCodeScanRegion = document.getElementById(this.getScanRegionId());\n    if (this.cameraScanImage) {\n      qrCodeScanRegion.innerHTML = \"<br>\";\n      qrCodeScanRegion.appendChild(this.cameraScanImage);\n      return;\n    }\n    this.cameraScanImage = new Image();\n    this.cameraScanImage.onload = function (_) {\n      qrCodeScanRegion.innerHTML = \"<br>\";\n      qrCodeScanRegion.appendChild($this.cameraScanImage);\n    };\n    this.cameraScanImage.width = 64;\n    this.cameraScanImage.style.opacity = \"0.8\";\n    this.cameraScanImage.src = ASSET_CAMERA_SCAN;\n    this.cameraScanImage.alt = Html5QrcodeScannerStrings.cameraScanAltText();\n  };\n  Html5QrcodeScanner.prototype.insertFileScanImageToScanRegion = function () {\n    var $this = this;\n    var qrCodeScanRegion = document.getElementById(this.getScanRegionId());\n    if (this.fileScanImage) {\n      qrCodeScanRegion.innerHTML = \"<br>\";\n      qrCodeScanRegion.appendChild(this.fileScanImage);\n      return;\n    }\n    this.fileScanImage = new Image();\n    this.fileScanImage.onload = function (_) {\n      qrCodeScanRegion.innerHTML = \"<br>\";\n      qrCodeScanRegion.appendChild($this.fileScanImage);\n    };\n    this.fileScanImage.width = 64;\n    this.fileScanImage.style.opacity = \"0.8\";\n    this.fileScanImage.src = ASSET_FILE_SCAN;\n    this.fileScanImage.alt = Html5QrcodeScannerStrings.fileScanAltText();\n  };\n  Html5QrcodeScanner.prototype.clearScanRegion = function () {\n    var qrCodeScanRegion = document.getElementById(this.getScanRegionId());\n    qrCodeScanRegion.innerHTML = \"\";\n  };\n  Html5QrcodeScanner.prototype.getDashboardSectionId = function () {\n    return \"\".concat(this.elementId, \"__dashboard_section\");\n  };\n  Html5QrcodeScanner.prototype.getDashboardSectionCameraScanRegionId = function () {\n    return \"\".concat(this.elementId, \"__dashboard_section_csr\");\n  };\n  Html5QrcodeScanner.prototype.getDashboardSectionSwapLinkId = function () {\n    return PublicUiElementIdAndClasses.SCAN_TYPE_CHANGE_ANCHOR_ID;\n  };\n  Html5QrcodeScanner.prototype.getScanRegionId = function () {\n    return \"\".concat(this.elementId, \"__scan_region\");\n  };\n  Html5QrcodeScanner.prototype.getDashboardId = function () {\n    return \"\".concat(this.elementId, \"__dashboard\");\n  };\n  Html5QrcodeScanner.prototype.getHeaderMessageContainerId = function () {\n    return \"\".concat(this.elementId, \"__header_message\");\n  };\n  Html5QrcodeScanner.prototype.getCameraPermissionButtonId = function () {\n    return PublicUiElementIdAndClasses.CAMERA_PERMISSION_BUTTON_ID;\n  };\n  Html5QrcodeScanner.prototype.getCameraScanRegion = function () {\n    return document.getElementById(this.getDashboardSectionCameraScanRegionId());\n  };\n  Html5QrcodeScanner.prototype.getDashboardSectionSwapLink = function () {\n    return document.getElementById(this.getDashboardSectionSwapLinkId());\n  };\n  Html5QrcodeScanner.prototype.getHeaderMessageDiv = function () {\n    return document.getElementById(this.getHeaderMessageContainerId());\n  };\n  return Html5QrcodeScanner;\n}();\nexport { Html5QrcodeScanner };","map":{"version":3,"sources":["../../src/html5-qrcode-scanner.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { Html5QrcodeConstants, Html5QrcodeScanType, Html5QrcodeErrorFactory, BaseLoggger, isNullOrUndefined, clip, } from \"./core\";\nimport { Html5Qrcode, } from \"./html5-qrcode\";\nimport { Html5QrcodeScannerStrings, } from \"./strings\";\nimport { ASSET_FILE_SCAN, ASSET_CAMERA_SCAN, } from \"./image-assets\";\nimport { PersistedDataManager } from \"./storage\";\nimport { LibraryInfoContainer } from \"./ui\";\nimport { CameraPermissions } from \"./camera/permissions\";\nimport { ScanTypeSelector } from \"./ui/scanner/scan-type-selector\";\nimport { TorchButton } from \"./ui/scanner/torch-button\";\nimport { FileSelectionUi } from \"./ui/scanner/file-selection-ui\";\nimport { BaseUiElementFactory, PublicUiElementIdAndClasses } from \"./ui/scanner/base\";\nimport { CameraSelectionUi } from \"./ui/scanner/camera-selection-ui\";\nimport { CameraZoomUi } from \"./ui/scanner/camera-zoom-ui\";\nvar Html5QrcodeScannerStatus;\n(function (Html5QrcodeScannerStatus) {\n    Html5QrcodeScannerStatus[Html5QrcodeScannerStatus[\"STATUS_DEFAULT\"] = 0] = \"STATUS_DEFAULT\";\n    Html5QrcodeScannerStatus[Html5QrcodeScannerStatus[\"STATUS_SUCCESS\"] = 1] = \"STATUS_SUCCESS\";\n    Html5QrcodeScannerStatus[Html5QrcodeScannerStatus[\"STATUS_WARNING\"] = 2] = \"STATUS_WARNING\";\n    Html5QrcodeScannerStatus[Html5QrcodeScannerStatus[\"STATUS_REQUESTING_PERMISSION\"] = 3] = \"STATUS_REQUESTING_PERMISSION\";\n})(Html5QrcodeScannerStatus || (Html5QrcodeScannerStatus = {}));\nfunction toHtml5QrcodeCameraScanConfig(config) {\n    return {\n        fps: config.fps,\n        qrbox: config.qrbox,\n        aspectRatio: config.aspectRatio,\n        disableFlip: config.disableFlip,\n        videoConstraints: config.videoConstraints\n    };\n}\nfunction toHtml5QrcodeFullConfig(config, verbose) {\n    return {\n        formatsToSupport: config.formatsToSupport,\n        useBarCodeDetectorIfSupported: config.useBarCodeDetectorIfSupported,\n        experimentalFeatures: config.experimentalFeatures,\n        verbose: verbose\n    };\n}\nvar Html5QrcodeScanner = (function () {\n    function Html5QrcodeScanner(elementId, config, verbose) {\n        this.lastMatchFound = null;\n        this.cameraScanImage = null;\n        this.fileScanImage = null;\n        this.fileSelectionUi = null;\n        this.elementId = elementId;\n        this.config = this.createConfig(config);\n        this.verbose = verbose === true;\n        if (!document.getElementById(elementId)) {\n            throw \"HTML Element with id=\".concat(elementId, \" not found\");\n        }\n        this.scanTypeSelector = new ScanTypeSelector(this.config.supportedScanTypes);\n        this.currentScanType = this.scanTypeSelector.getDefaultScanType();\n        this.sectionSwapAllowed = true;\n        this.logger = new BaseLoggger(this.verbose);\n        this.persistedDataManager = new PersistedDataManager();\n        if (config.rememberLastUsedCamera !== true) {\n            this.persistedDataManager.reset();\n        }\n    }\n    Html5QrcodeScanner.prototype.render = function (qrCodeSuccessCallback, qrCodeErrorCallback) {\n        var _this = this;\n        this.lastMatchFound = null;\n        this.qrCodeSuccessCallback\n            = function (decodedText, result) {\n                if (qrCodeSuccessCallback) {\n                    qrCodeSuccessCallback(decodedText, result);\n                }\n                else {\n                    if (_this.lastMatchFound === decodedText) {\n                        return;\n                    }\n                    _this.lastMatchFound = decodedText;\n                    _this.setHeaderMessage(Html5QrcodeScannerStrings.lastMatch(decodedText), Html5QrcodeScannerStatus.STATUS_SUCCESS);\n                }\n            };\n        this.qrCodeErrorCallback =\n            function (errorMessage, error) {\n                if (qrCodeErrorCallback) {\n                    qrCodeErrorCallback(errorMessage, error);\n                }\n            };\n        var container = document.getElementById(this.elementId);\n        if (!container) {\n            throw \"HTML Element with id=\".concat(this.elementId, \" not found\");\n        }\n        container.innerHTML = \"\";\n        this.createBasicLayout(container);\n        this.html5Qrcode = new Html5Qrcode(this.getScanRegionId(), toHtml5QrcodeFullConfig(this.config, this.verbose));\n    };\n    Html5QrcodeScanner.prototype.pause = function (shouldPauseVideo) {\n        if (isNullOrUndefined(shouldPauseVideo) || shouldPauseVideo !== true) {\n            shouldPauseVideo = false;\n        }\n        this.getHtml5QrcodeOrFail().pause(shouldPauseVideo);\n    };\n    Html5QrcodeScanner.prototype.resume = function () {\n        this.getHtml5QrcodeOrFail().resume();\n    };\n    Html5QrcodeScanner.prototype.getState = function () {\n        return this.getHtml5QrcodeOrFail().getState();\n    };\n    Html5QrcodeScanner.prototype.clear = function () {\n        var _this = this;\n        var emptyHtmlContainer = function () {\n            var mainContainer = document.getElementById(_this.elementId);\n            if (mainContainer) {\n                mainContainer.innerHTML = \"\";\n                _this.resetBasicLayout(mainContainer);\n            }\n        };\n        if (this.html5Qrcode) {\n            return new Promise(function (resolve, reject) {\n                if (!_this.html5Qrcode) {\n                    resolve();\n                    return;\n                }\n                if (_this.html5Qrcode.isScanning) {\n                    _this.html5Qrcode.stop().then(function (_) {\n                        if (!_this.html5Qrcode) {\n                            resolve();\n                            return;\n                        }\n                        _this.html5Qrcode.clear();\n                        emptyHtmlContainer();\n                        resolve();\n                    }).catch(function (error) {\n                        if (_this.verbose) {\n                            _this.logger.logError(\"Unable to stop qrcode scanner\", error);\n                        }\n                        reject(error);\n                    });\n                }\n                else {\n                    _this.html5Qrcode.clear();\n                    emptyHtmlContainer();\n                    resolve();\n                }\n            });\n        }\n        return Promise.resolve();\n    };\n    Html5QrcodeScanner.prototype.getRunningTrackCapabilities = function () {\n        return this.getHtml5QrcodeOrFail().getRunningTrackCapabilities();\n    };\n    Html5QrcodeScanner.prototype.getRunningTrackSettings = function () {\n        return this.getHtml5QrcodeOrFail().getRunningTrackSettings();\n    };\n    Html5QrcodeScanner.prototype.applyVideoConstraints = function (videoConstaints) {\n        return this.getHtml5QrcodeOrFail().applyVideoConstraints(videoConstaints);\n    };\n    Html5QrcodeScanner.prototype.getHtml5QrcodeOrFail = function () {\n        if (!this.html5Qrcode) {\n            throw \"Code scanner not initialized.\";\n        }\n        return this.html5Qrcode;\n    };\n    Html5QrcodeScanner.prototype.createConfig = function (config) {\n        if (config) {\n            if (!config.fps) {\n                config.fps = Html5QrcodeConstants.SCAN_DEFAULT_FPS;\n            }\n            if (config.rememberLastUsedCamera !== (!Html5QrcodeConstants.DEFAULT_REMEMBER_LAST_CAMERA_USED)) {\n                config.rememberLastUsedCamera\n                    = Html5QrcodeConstants.DEFAULT_REMEMBER_LAST_CAMERA_USED;\n            }\n            if (!config.supportedScanTypes) {\n                config.supportedScanTypes\n                    = Html5QrcodeConstants.DEFAULT_SUPPORTED_SCAN_TYPE;\n            }\n            return config;\n        }\n        return {\n            fps: Html5QrcodeConstants.SCAN_DEFAULT_FPS,\n            rememberLastUsedCamera: Html5QrcodeConstants.DEFAULT_REMEMBER_LAST_CAMERA_USED,\n            supportedScanTypes: Html5QrcodeConstants.DEFAULT_SUPPORTED_SCAN_TYPE\n        };\n    };\n    Html5QrcodeScanner.prototype.createBasicLayout = function (parent) {\n        parent.style.position = \"relative\";\n        parent.style.padding = \"0px\";\n        parent.style.border = \"1px solid silver\";\n        this.createHeader(parent);\n        var qrCodeScanRegion = document.createElement(\"div\");\n        var scanRegionId = this.getScanRegionId();\n        qrCodeScanRegion.id = scanRegionId;\n        qrCodeScanRegion.style.width = \"100%\";\n        qrCodeScanRegion.style.minHeight = \"100px\";\n        qrCodeScanRegion.style.textAlign = \"center\";\n        parent.appendChild(qrCodeScanRegion);\n        if (ScanTypeSelector.isCameraScanType(this.currentScanType)) {\n            this.insertCameraScanImageToScanRegion();\n        }\n        else {\n            this.insertFileScanImageToScanRegion();\n        }\n        var qrCodeDashboard = document.createElement(\"div\");\n        var dashboardId = this.getDashboardId();\n        qrCodeDashboard.id = dashboardId;\n        qrCodeDashboard.style.width = \"100%\";\n        parent.appendChild(qrCodeDashboard);\n        this.setupInitialDashboard(qrCodeDashboard);\n    };\n    Html5QrcodeScanner.prototype.resetBasicLayout = function (mainContainer) {\n        mainContainer.style.border = \"none\";\n    };\n    Html5QrcodeScanner.prototype.setupInitialDashboard = function (dashboard) {\n        this.createSection(dashboard);\n        this.createSectionControlPanel();\n        if (this.scanTypeSelector.hasMoreThanOneScanType()) {\n            this.createSectionSwap();\n        }\n    };\n    Html5QrcodeScanner.prototype.createHeader = function (dashboard) {\n        var header = document.createElement(\"div\");\n        header.style.textAlign = \"left\";\n        header.style.margin = \"0px\";\n        dashboard.appendChild(header);\n        var libraryInfo = new LibraryInfoContainer();\n        libraryInfo.renderInto(header);\n        var headerMessageContainer = document.createElement(\"div\");\n        headerMessageContainer.id = this.getHeaderMessageContainerId();\n        headerMessageContainer.style.display = \"none\";\n        headerMessageContainer.style.textAlign = \"center\";\n        headerMessageContainer.style.fontSize = \"14px\";\n        headerMessageContainer.style.padding = \"2px 10px\";\n        headerMessageContainer.style.margin = \"4px\";\n        headerMessageContainer.style.borderTop = \"1px solid #f6f6f6\";\n        header.appendChild(headerMessageContainer);\n    };\n    Html5QrcodeScanner.prototype.createSection = function (dashboard) {\n        var section = document.createElement(\"div\");\n        section.id = this.getDashboardSectionId();\n        section.style.width = \"100%\";\n        section.style.padding = \"10px 0px 10px 0px\";\n        section.style.textAlign = \"left\";\n        dashboard.appendChild(section);\n    };\n    Html5QrcodeScanner.prototype.createCameraListUi = function (scpCameraScanRegion, requestPermissionContainer, requestPermissionButton) {\n        var $this = this;\n        $this.showHideScanTypeSwapLink(false);\n        $this.setHeaderMessage(Html5QrcodeScannerStrings.cameraPermissionRequesting());\n        var createPermissionButtonIfNotExists = function () {\n            if (!requestPermissionButton) {\n                $this.createPermissionButton(scpCameraScanRegion, requestPermissionContainer);\n            }\n        };\n        Html5Qrcode.getCameras().then(function (cameras) {\n            $this.persistedDataManager.setHasPermission(true);\n            $this.showHideScanTypeSwapLink(true);\n            $this.resetHeaderMessage();\n            if (cameras && cameras.length > 0) {\n                scpCameraScanRegion.removeChild(requestPermissionContainer);\n                $this.renderCameraSelection(cameras);\n            }\n            else {\n                $this.setHeaderMessage(Html5QrcodeScannerStrings.noCameraFound(), Html5QrcodeScannerStatus.STATUS_WARNING);\n                createPermissionButtonIfNotExists();\n            }\n        }).catch(function (error) {\n            $this.persistedDataManager.setHasPermission(false);\n            if (requestPermissionButton) {\n                requestPermissionButton.disabled = false;\n            }\n            else {\n                createPermissionButtonIfNotExists();\n            }\n            $this.setHeaderMessage(error, Html5QrcodeScannerStatus.STATUS_WARNING);\n            $this.showHideScanTypeSwapLink(true);\n        });\n    };\n    Html5QrcodeScanner.prototype.createPermissionButton = function (scpCameraScanRegion, requestPermissionContainer) {\n        var $this = this;\n        var requestPermissionButton = BaseUiElementFactory\n            .createElement(\"button\", this.getCameraPermissionButtonId());\n        requestPermissionButton.innerText\n            = Html5QrcodeScannerStrings.cameraPermissionTitle();\n        requestPermissionButton.addEventListener(\"click\", function () {\n            requestPermissionButton.disabled = true;\n            $this.createCameraListUi(scpCameraScanRegion, requestPermissionContainer, requestPermissionButton);\n        });\n        requestPermissionContainer.appendChild(requestPermissionButton);\n    };\n    Html5QrcodeScanner.prototype.createPermissionsUi = function (scpCameraScanRegion, requestPermissionContainer) {\n        var $this = this;\n        if (ScanTypeSelector.isCameraScanType(this.currentScanType)\n            && this.persistedDataManager.hasCameraPermissions()) {\n            CameraPermissions.hasPermissions().then(function (hasPermissions) {\n                if (hasPermissions) {\n                    $this.createCameraListUi(scpCameraScanRegion, requestPermissionContainer);\n                }\n                else {\n                    $this.persistedDataManager.setHasPermission(false);\n                    $this.createPermissionButton(scpCameraScanRegion, requestPermissionContainer);\n                }\n            }).catch(function (_) {\n                $this.persistedDataManager.setHasPermission(false);\n                $this.createPermissionButton(scpCameraScanRegion, requestPermissionContainer);\n            });\n            return;\n        }\n        this.createPermissionButton(scpCameraScanRegion, requestPermissionContainer);\n    };\n    Html5QrcodeScanner.prototype.createSectionControlPanel = function () {\n        var section = document.getElementById(this.getDashboardSectionId());\n        var sectionControlPanel = document.createElement(\"div\");\n        section.appendChild(sectionControlPanel);\n        var scpCameraScanRegion = document.createElement(\"div\");\n        scpCameraScanRegion.id = this.getDashboardSectionCameraScanRegionId();\n        scpCameraScanRegion.style.display\n            = ScanTypeSelector.isCameraScanType(this.currentScanType)\n                ? \"block\" : \"none\";\n        sectionControlPanel.appendChild(scpCameraScanRegion);\n        var requestPermissionContainer = document.createElement(\"div\");\n        requestPermissionContainer.style.textAlign = \"center\";\n        scpCameraScanRegion.appendChild(requestPermissionContainer);\n        if (this.scanTypeSelector.isCameraScanRequired()) {\n            this.createPermissionsUi(scpCameraScanRegion, requestPermissionContainer);\n        }\n        this.renderFileScanUi(sectionControlPanel);\n    };\n    Html5QrcodeScanner.prototype.renderFileScanUi = function (parent) {\n        var showOnRender = ScanTypeSelector.isFileScanType(this.currentScanType);\n        var $this = this;\n        var onFileSelected = function (file) {\n            if (!$this.html5Qrcode) {\n                throw \"html5Qrcode not defined\";\n            }\n            if (!ScanTypeSelector.isFileScanType($this.currentScanType)) {\n                return;\n            }\n            $this.setHeaderMessage(Html5QrcodeScannerStrings.loadingImage());\n            $this.html5Qrcode.scanFileV2(file, true)\n                .then(function (html5qrcodeResult) {\n                $this.resetHeaderMessage();\n                $this.qrCodeSuccessCallback(html5qrcodeResult.decodedText, html5qrcodeResult);\n            })\n                .catch(function (error) {\n                $this.setHeaderMessage(error, Html5QrcodeScannerStatus.STATUS_WARNING);\n                $this.qrCodeErrorCallback(error, Html5QrcodeErrorFactory.createFrom(error));\n            });\n        };\n        this.fileSelectionUi = FileSelectionUi.create(parent, showOnRender, onFileSelected);\n    };\n    Html5QrcodeScanner.prototype.renderCameraSelection = function (cameras) {\n        var _this = this;\n        var $this = this;\n        var scpCameraScanRegion = document.getElementById(this.getDashboardSectionCameraScanRegionId());\n        scpCameraScanRegion.style.textAlign = \"center\";\n        var cameraZoomUi = CameraZoomUi.create(scpCameraScanRegion, false);\n        var renderCameraZoomUiIfSupported = function (cameraCapabilities) {\n            var zoomCapability = cameraCapabilities.zoomFeature();\n            if (!zoomCapability.isSupported()) {\n                return;\n            }\n            cameraZoomUi.setOnCameraZoomValueChangeCallback(function (zoomValue) {\n                zoomCapability.apply(zoomValue);\n            });\n            var defaultZoom = 1;\n            if (_this.config.defaultZoomValueIfSupported) {\n                defaultZoom = _this.config.defaultZoomValueIfSupported;\n            }\n            defaultZoom = clip(defaultZoom, zoomCapability.min(), zoomCapability.max());\n            cameraZoomUi.setValues(zoomCapability.min(), zoomCapability.max(), defaultZoom, zoomCapability.step());\n            cameraZoomUi.show();\n        };\n        var cameraSelectUi = CameraSelectionUi.create(scpCameraScanRegion, cameras);\n        var cameraActionContainer = document.createElement(\"span\");\n        var cameraActionStartButton = BaseUiElementFactory.createElement(\"button\", PublicUiElementIdAndClasses.CAMERA_START_BUTTON_ID);\n        cameraActionStartButton.innerText\n            = Html5QrcodeScannerStrings.scanButtonStartScanningText();\n        cameraActionContainer.appendChild(cameraActionStartButton);\n        var cameraActionStopButton = BaseUiElementFactory.createElement(\"button\", PublicUiElementIdAndClasses.CAMERA_STOP_BUTTON_ID);\n        cameraActionStopButton.innerText\n            = Html5QrcodeScannerStrings.scanButtonStopScanningText();\n        cameraActionStopButton.style.display = \"none\";\n        cameraActionStopButton.disabled = true;\n        cameraActionContainer.appendChild(cameraActionStopButton);\n        var torchButton;\n        var createAndShowTorchButtonIfSupported = function (cameraCapabilities) {\n            if (!cameraCapabilities.torchFeature().isSupported()) {\n                if (torchButton) {\n                    torchButton.hide();\n                }\n                return;\n            }\n            if (!torchButton) {\n                torchButton = TorchButton.create(cameraActionContainer, cameraCapabilities.torchFeature(), { display: \"none\", marginLeft: \"5px\" }, function (errorMessage) {\n                    $this.setHeaderMessage(errorMessage, Html5QrcodeScannerStatus.STATUS_WARNING);\n                });\n            }\n            else {\n                torchButton.updateTorchCapability(cameraCapabilities.torchFeature());\n            }\n            torchButton.show();\n        };\n        scpCameraScanRegion.appendChild(cameraActionContainer);\n        var resetCameraActionStartButton = function (shouldShow) {\n            if (!shouldShow) {\n                cameraActionStartButton.style.display = \"none\";\n            }\n            cameraActionStartButton.innerText\n                = Html5QrcodeScannerStrings\n                    .scanButtonStartScanningText();\n            cameraActionStartButton.style.opacity = \"1\";\n            cameraActionStartButton.disabled = false;\n            if (shouldShow) {\n                cameraActionStartButton.style.display = \"inline-block\";\n            }\n        };\n        cameraActionStartButton.addEventListener(\"click\", function (_) {\n            cameraActionStartButton.innerText\n                = Html5QrcodeScannerStrings.scanButtonScanningStarting();\n            cameraSelectUi.disable();\n            cameraActionStartButton.disabled = true;\n            cameraActionStartButton.style.opacity = \"0.5\";\n            if (_this.scanTypeSelector.hasMoreThanOneScanType()) {\n                $this.showHideScanTypeSwapLink(false);\n            }\n            $this.resetHeaderMessage();\n            var cameraId = cameraSelectUi.getValue();\n            $this.persistedDataManager.setLastUsedCameraId(cameraId);\n            $this.html5Qrcode.start(cameraId, toHtml5QrcodeCameraScanConfig($this.config), $this.qrCodeSuccessCallback, $this.qrCodeErrorCallback)\n                .then(function (_) {\n                cameraActionStopButton.disabled = false;\n                cameraActionStopButton.style.display = \"inline-block\";\n                resetCameraActionStartButton(false);\n                var cameraCapabilities = $this.html5Qrcode.getRunningTrackCameraCapabilities();\n                if (_this.config.showTorchButtonIfSupported === true) {\n                    createAndShowTorchButtonIfSupported(cameraCapabilities);\n                }\n                if (_this.config.showZoomSliderIfSupported === true) {\n                    renderCameraZoomUiIfSupported(cameraCapabilities);\n                }\n            })\n                .catch(function (error) {\n                $this.showHideScanTypeSwapLink(true);\n                cameraSelectUi.enable();\n                resetCameraActionStartButton(true);\n                $this.setHeaderMessage(error, Html5QrcodeScannerStatus.STATUS_WARNING);\n            });\n        });\n        if (cameraSelectUi.hasSingleItem()) {\n            cameraActionStartButton.click();\n        }\n        cameraActionStopButton.addEventListener(\"click\", function (_) {\n            if (!$this.html5Qrcode) {\n                throw \"html5Qrcode not defined\";\n            }\n            cameraActionStopButton.disabled = true;\n            $this.html5Qrcode.stop()\n                .then(function (_) {\n                if (_this.scanTypeSelector.hasMoreThanOneScanType()) {\n                    $this.showHideScanTypeSwapLink(true);\n                }\n                cameraSelectUi.enable();\n                cameraActionStartButton.disabled = false;\n                cameraActionStopButton.style.display = \"none\";\n                cameraActionStartButton.style.display = \"inline-block\";\n                if (torchButton) {\n                    torchButton.reset();\n                    torchButton.hide();\n                }\n                cameraZoomUi.removeOnCameraZoomValueChangeCallback();\n                cameraZoomUi.hide();\n                $this.insertCameraScanImageToScanRegion();\n            }).catch(function (error) {\n                cameraActionStopButton.disabled = false;\n                $this.setHeaderMessage(error, Html5QrcodeScannerStatus.STATUS_WARNING);\n            });\n        });\n        if ($this.persistedDataManager.getLastUsedCameraId()) {\n            var cameraId = $this.persistedDataManager.getLastUsedCameraId();\n            if (cameraSelectUi.hasValue(cameraId)) {\n                cameraSelectUi.setValue(cameraId);\n                cameraActionStartButton.click();\n            }\n            else {\n                $this.persistedDataManager.resetLastUsedCameraId();\n            }\n        }\n    };\n    Html5QrcodeScanner.prototype.createSectionSwap = function () {\n        var $this = this;\n        var TEXT_IF_CAMERA_SCAN_SELECTED = Html5QrcodeScannerStrings.textIfCameraScanSelected();\n        var TEXT_IF_FILE_SCAN_SELECTED = Html5QrcodeScannerStrings.textIfFileScanSelected();\n        var section = document.getElementById(this.getDashboardSectionId());\n        var switchContainer = document.createElement(\"div\");\n        switchContainer.style.textAlign = \"center\";\n        var switchScanTypeLink = BaseUiElementFactory.createElement(\"span\", this.getDashboardSectionSwapLinkId());\n        switchScanTypeLink.style.textDecoration = \"underline\";\n        switchScanTypeLink.style.cursor = \"pointer\";\n        switchScanTypeLink.innerText\n            = ScanTypeSelector.isCameraScanType(this.currentScanType)\n                ? TEXT_IF_CAMERA_SCAN_SELECTED : TEXT_IF_FILE_SCAN_SELECTED;\n        switchScanTypeLink.addEventListener(\"click\", function () {\n            if (!$this.sectionSwapAllowed) {\n                if ($this.verbose) {\n                    $this.logger.logError(\"Section swap called when not allowed\");\n                }\n                return;\n            }\n            $this.resetHeaderMessage();\n            $this.fileSelectionUi.resetValue();\n            $this.sectionSwapAllowed = false;\n            if (ScanTypeSelector.isCameraScanType($this.currentScanType)) {\n                $this.clearScanRegion();\n                $this.getCameraScanRegion().style.display = \"none\";\n                $this.fileSelectionUi.show();\n                switchScanTypeLink.innerText = TEXT_IF_FILE_SCAN_SELECTED;\n                $this.currentScanType = Html5QrcodeScanType.SCAN_TYPE_FILE;\n                $this.insertFileScanImageToScanRegion();\n            }\n            else {\n                $this.clearScanRegion();\n                $this.getCameraScanRegion().style.display = \"block\";\n                $this.fileSelectionUi.hide();\n                switchScanTypeLink.innerText = TEXT_IF_CAMERA_SCAN_SELECTED;\n                $this.currentScanType = Html5QrcodeScanType.SCAN_TYPE_CAMERA;\n                $this.insertCameraScanImageToScanRegion();\n                $this.startCameraScanIfPermissionExistsOnSwap();\n            }\n            $this.sectionSwapAllowed = true;\n        });\n        switchContainer.appendChild(switchScanTypeLink);\n        section.appendChild(switchContainer);\n    };\n    Html5QrcodeScanner.prototype.startCameraScanIfPermissionExistsOnSwap = function () {\n        var _this = this;\n        var $this = this;\n        if (this.persistedDataManager.hasCameraPermissions()) {\n            CameraPermissions.hasPermissions().then(function (hasPermissions) {\n                if (hasPermissions) {\n                    var permissionButton = document.getElementById($this.getCameraPermissionButtonId());\n                    if (!permissionButton) {\n                        _this.logger.logError(\"Permission button not found, fail;\");\n                        throw \"Permission button not found\";\n                    }\n                    permissionButton.click();\n                }\n                else {\n                    $this.persistedDataManager.setHasPermission(false);\n                }\n            }).catch(function (_) {\n                $this.persistedDataManager.setHasPermission(false);\n            });\n            return;\n        }\n    };\n    Html5QrcodeScanner.prototype.resetHeaderMessage = function () {\n        var messageDiv = document.getElementById(this.getHeaderMessageContainerId());\n        messageDiv.style.display = \"none\";\n    };\n    Html5QrcodeScanner.prototype.setHeaderMessage = function (messageText, scannerStatus) {\n        if (!scannerStatus) {\n            scannerStatus = Html5QrcodeScannerStatus.STATUS_DEFAULT;\n        }\n        var messageDiv = this.getHeaderMessageDiv();\n        messageDiv.innerText = messageText;\n        messageDiv.style.display = \"block\";\n        switch (scannerStatus) {\n            case Html5QrcodeScannerStatus.STATUS_SUCCESS:\n                messageDiv.style.background = \"rgba(106, 175, 80, 0.26)\";\n                messageDiv.style.color = \"#477735\";\n                break;\n            case Html5QrcodeScannerStatus.STATUS_WARNING:\n                messageDiv.style.background = \"rgba(203, 36, 49, 0.14)\";\n                messageDiv.style.color = \"#cb2431\";\n                break;\n            case Html5QrcodeScannerStatus.STATUS_DEFAULT:\n            default:\n                messageDiv.style.background = \"rgba(0, 0, 0, 0)\";\n                messageDiv.style.color = \"rgb(17, 17, 17)\";\n                break;\n        }\n    };\n    Html5QrcodeScanner.prototype.showHideScanTypeSwapLink = function (shouldDisplay) {\n        if (this.scanTypeSelector.hasMoreThanOneScanType()) {\n            if (shouldDisplay !== true) {\n                shouldDisplay = false;\n            }\n            this.sectionSwapAllowed = shouldDisplay;\n            this.getDashboardSectionSwapLink().style.display\n                = shouldDisplay ? \"inline-block\" : \"none\";\n        }\n    };\n    Html5QrcodeScanner.prototype.insertCameraScanImageToScanRegion = function () {\n        var $this = this;\n        var qrCodeScanRegion = document.getElementById(this.getScanRegionId());\n        if (this.cameraScanImage) {\n            qrCodeScanRegion.innerHTML = \"<br>\";\n            qrCodeScanRegion.appendChild(this.cameraScanImage);\n            return;\n        }\n        this.cameraScanImage = new Image;\n        this.cameraScanImage.onload = function (_) {\n            qrCodeScanRegion.innerHTML = \"<br>\";\n            qrCodeScanRegion.appendChild($this.cameraScanImage);\n        };\n        this.cameraScanImage.width = 64;\n        this.cameraScanImage.style.opacity = \"0.8\";\n        this.cameraScanImage.src = ASSET_CAMERA_SCAN;\n        this.cameraScanImage.alt = Html5QrcodeScannerStrings.cameraScanAltText();\n    };\n    Html5QrcodeScanner.prototype.insertFileScanImageToScanRegion = function () {\n        var $this = this;\n        var qrCodeScanRegion = document.getElementById(this.getScanRegionId());\n        if (this.fileScanImage) {\n            qrCodeScanRegion.innerHTML = \"<br>\";\n            qrCodeScanRegion.appendChild(this.fileScanImage);\n            return;\n        }\n        this.fileScanImage = new Image;\n        this.fileScanImage.onload = function (_) {\n            qrCodeScanRegion.innerHTML = \"<br>\";\n            qrCodeScanRegion.appendChild($this.fileScanImage);\n        };\n        this.fileScanImage.width = 64;\n        this.fileScanImage.style.opacity = \"0.8\";\n        this.fileScanImage.src = ASSET_FILE_SCAN;\n        this.fileScanImage.alt = Html5QrcodeScannerStrings.fileScanAltText();\n    };\n    Html5QrcodeScanner.prototype.clearScanRegion = function () {\n        var qrCodeScanRegion = document.getElementById(this.getScanRegionId());\n        qrCodeScanRegion.innerHTML = \"\";\n    };\n    Html5QrcodeScanner.prototype.getDashboardSectionId = function () {\n        return \"\".concat(this.elementId, \"__dashboard_section\");\n    };\n    Html5QrcodeScanner.prototype.getDashboardSectionCameraScanRegionId = function () {\n        return \"\".concat(this.elementId, \"__dashboard_section_csr\");\n    };\n    Html5QrcodeScanner.prototype.getDashboardSectionSwapLinkId = function () {\n        return PublicUiElementIdAndClasses.SCAN_TYPE_CHANGE_ANCHOR_ID;\n    };\n    Html5QrcodeScanner.prototype.getScanRegionId = function () {\n        return \"\".concat(this.elementId, \"__scan_region\");\n    };\n    Html5QrcodeScanner.prototype.getDashboardId = function () {\n        return \"\".concat(this.elementId, \"__dashboard\");\n    };\n    Html5QrcodeScanner.prototype.getHeaderMessageContainerId = function () {\n        return \"\".concat(this.elementId, \"__header_message\");\n    };\n    Html5QrcodeScanner.prototype.getCameraPermissionButtonId = function () {\n        return PublicUiElementIdAndClasses.CAMERA_PERMISSION_BUTTON_ID;\n    };\n    Html5QrcodeScanner.prototype.getCameraScanRegion = function () {\n        return document.getElementById(this.getDashboardSectionCameraScanRegionId());\n    };\n    Html5QrcodeScanner.prototype.getDashboardSectionSwapLink = function () {\n        return document.getElementById(this.getDashboardSectionSwapLinkId());\n    };\n    Html5QrcodeScanner.prototype.getHeaderMessageDiv = function () {\n        return document.getElementById(this.getHeaderMessageContainerId());\n    };\n    return Html5QrcodeScanner;\n}());\nexport { Html5QrcodeScanner };\n//# sourceMappingURL=html5-qrcode-scanner.js.map"]},"metadata":{},"sourceType":"module"}